<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CanIFish - Water Conditions Dashboard</title>
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <a class="skip-link" href="#main-content">Skip to main content</a>
    <div class="container">
        <header class="header" role="banner">
            <h1>🎣 Can I Fish</h1>
            <p>Real-time Water Conditions Dashboard</p>
        </header>

        <main id="main-content" class="main-content" role="main" aria-live="polite">
            <section class="site-info" aria-labelledby="site-info-heading">
            <h2 id="site-info-heading">Buford Dam and Chattahoochee River near Norcross, GA</h2>
            <p><strong>USGS Site:</strong> <a target="_blank" rel="noopener" href="https://dashboard.waterdata.usgs.gov/api/gwis/2.1.1/service/site?agencyCode=USGS&siteNumber=02335000&open=39509">02335000</a></p>
            <p><strong>USACE:</strong> <a target="_blank" rel="noopener" href="https://spatialdata.usace.army.mil/hydropower/">Buford Dam/Lake Sidney Lanier</a> | Buford Dam – Water Release information 770-945-1466</p>
            </section>

            <section class="controls" aria-label="Data controls">
            <button class="btn" onclick="loadWaterData()">🔄 Refresh Data</button>
            <label for="period-select" class="sr-only">Select data period</label>
            <select class="period-select" id="period-select" onchange="changePeriod()">
                <option value="PT3H" selected>Last 3 Hours</option>
                <option value="PT6H">Last 6 Hours</option>
                <option value="PT12H">Last 12 Hours</option>
                <option value="P1D">Last 24 Hours</option>
                <option value="P3D">Last 3 Days</option>
                <option value="P7D">Last 7 Days</option>
                <option value="P30D">Last 30 Days</option>
            </select>
            <div class="temp-unit-toggle" role="group" aria-label="Temperature unit toggle">
                <span class="temp-unit-label" aria-hidden="true">🌡️</span>
                <span class="temp-unit-text" aria-hidden="true">°C</span>
                <label class="temp-toggle-switch">
                    <span class="sr-only">Toggle temperature units between Celsius and Fahrenheit</span>
                    <input type="checkbox" id="temp-toggle" class="temp-toggle-input" onchange="toggleTemperatureUnit(event)" checked>
                    <span class="temp-toggle-slider" aria-hidden="true"></span>
                </label>
                <span class="temp-unit-text" aria-hidden="true">°F</span>
            </div>
            <button class="filters-toggle-btn" id="filters-toggle-btn" onclick="toggleFiltersVisibility()">Show Filters</button>
            </section>

        <div id="loading" class="loading" role="status" aria-live="polite" style="display: none;">
            <p>🌊 Loading water conditions...</p>
        </div>

        <div id="error" class="error" role="alert" aria-live="assertive" style="display: none;"></div>

        <div id="category-filters" class="category-filters" style="display: none;" role="region" aria-label="Category filters">
            <div class="filters-title">📊 Category Filters</div>
            <div id="filters-content" class="filters-content expanded">
                <div class="filter-controls">
                    <button class="filter-btn active" onclick="toggleAllCategories(true)">Show All</button>
                    <button class="filter-btn" onclick="toggleAllCategories(false)">Hide All</button>
                </div>
                <div id="category-toggles" class="category-toggles">
                    <!-- Category toggles will be dynamically generated -->
                </div>
            </div>
        </div>

        <div id="summary-cards-section" class="summary-cards-section" style="display: none;" role="region" aria-label="Current conditions summary">
            <div class="summary-cards-header">
                <div class="summary-cards-title">📊 Current Conditions</div>
                <button class="summary-toggle-btn" id="summary-toggle-btn" onclick="toggleSummaryVisibility()">Hide Summary</button>
            </div>
            <div id="summary-skeletons" class="summary-cards-container skeleton-container" aria-hidden="true" hidden>
                <div class="summary-card skeleton-card">
                    <div class="skeleton skeleton-title"></div>
                    <div class="skeleton skeleton-value"></div>
                    <div class="skeleton skeleton-subtext"></div>
                </div>
                <div class="summary-card skeleton-card">
                    <div class="skeleton skeleton-title"></div>
                    <div class="skeleton skeleton-value"></div>
                    <div class="skeleton skeleton-subtext"></div>
                </div>
            </div>
            <div id="summary-cards" class="summary-cards-container" aria-live="polite"></div>
        </div>

        <div id="data-tables-section" class="data-tables-section" style="display: none;" role="region" aria-label="Historical data tables">
            <div class="data-tables-header">
                <div class="data-tables-title">📋 Historical Data Tables</div>
                <button class="data-tables-toggle-btn" id="data-tables-toggle-btn" onclick="toggleDataTablesVisibility()">Hide Tables</button>
            </div>
            <div id="tables-skeleton" class="table-skeleton" aria-hidden="true" hidden>
                <div class="skeleton skeleton-row"></div>
                <div class="skeleton skeleton-row"></div>
                <div class="skeleton skeleton-row"></div>
            </div>
            <div id="data-container"></div>
        </div>

        <div id="usace-section" class="usace-section" style="display: none;" role="region" aria-label="Dam generation schedule">
            <div class="usace-header">
                <div>
                    <div class="usace-title">🏗️ Dam Generation Schedule</div>
                    <div class="usace-subtitle">Buford Dam/Lake Sidney Lanier - USACE</div>
                </div>
                <div class="usace-controls">
                    <div id="current-generation-status" class="generation-status" aria-live="polite">
                        <span>Loading...</span>
                    </div>
                    <button class="usace-toggle-btn" id="usace-toggle-btn" onclick="toggleUSACEVisibility()">Hide Dam Data</button>
                </div>
            </div>
            <div id="usace-skeleton" class="table-skeleton" aria-hidden="true" hidden>
                <div class="skeleton skeleton-row"></div>
                <div class="skeleton skeleton-row"></div>
            </div>
            <div id="generation-tables" class="generation-tables">
                <!-- Generation schedule tables will be populated here -->
            </div>
            <div id="usace-info" class="usace-info">
                <h4>🎣 Fishing Impact</h4>
                <p><strong>Base Generation (Low):</strong> Minimal water release - Better for wading and bank fishing</p>
                <p><strong>Peak Generation (High):</strong> Heavy water release - Dangerous conditions, avoid wading</p>
                <p><strong>Intermediate:</strong> Moderate release - Use caution, water levels rising</p>
            </div>
        </div>

            <div id="last-updated" class="last-updated" aria-live="polite"></div>
        </main>

        <footer class="site-footer" role="contentinfo">
        
        <div class="legal-disclaimer">
            <p><strong>Legal Disclaimer:</strong> The information provided on this page is for informational purposes only. I accept no responsibility for the use or accuracy of the information displayed. Water conditions can change rapidly and may be dangerous. Always exercise caution around water bodies and consult official sources before making decisions related to water activities. Use this information at your own risk.</p>
        </div>
        <div class="proxy-attribution">
            <p><strong>Data Proxies:</strong> API calls may route through <a href="https://allorigins.win" target="_blank" rel="noopener">AllOrigins</a>, <a href="https://corsproxy.io" target="_blank" rel="noopener">corsproxy.io</a>, or <a href="https://cors-anywhere.herokuapp.com/" target="_blank" rel="noopener">CORS Anywhere</a>. Availability depends on those third-party services.</p>
        </div>
        </footer>
    </div>

        <script src="app.js" defer></script>
</body>
</html>
